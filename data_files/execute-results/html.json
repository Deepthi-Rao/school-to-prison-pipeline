{
  "hash": "c54f7b2f8922cdcac45666d954ced5c6",
  "result": {
    "engine": "knitr",
    "markdown": "# Data\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(dplyr)\n\n# 1. Read the Excel file into a *data frame*\ndf <- read_excel(\"./data/2020-2021/CRDC_2020-21_AK.xlsx\", sheet = 1)\n\n# 2. Filter to the relevant columns\ndf_filtered <- df |>\n  select(\n    # ID/context columns if they exist\n    any_of(c(\"LEA_STATE\", \"LEAID\", \"SCH_ID\", \"SCH_NAME\")),\n    \n    # total enrollment by gender\n    any_of(c(\"TOT_ENR_M\", \"TOT_ENR_F\")),\n    \n    # race-specific enrollment: SCH_ENR_[RACE]_[M/F]\n    matches(\"^SCH_ENR_.*_[MF]$\"),\n    \n    # discipline: in-school + out-of-school suspensions\n    matches(\"^SCH_(DISCWODIS|DISCWDIS)_\"),\n    \n    # expulsion / alternative placements\n    matches(\"^SCH_(DISCWODIS|DISCWDIS)_(EXP|EXPEL|ALT|ALTR)_\"),\n    \n    # law enforcement: referrals + arrests\n    matches(\"^SCH_(DISCWODIS|DISCWDIS)_(REF|ARR)_\")\n  )\n```\n:::\n\n\nhttps://civilrightsdata.ed.gov/view\n\nThe data that I obtained was from the Civil Rights Data Collection owned and maintained by the U.S Department of Education. All public schools K-12, across the 50 states, including charter schools self-report this data. The file format for the 2020-2021 time frame was mainly available in .xlsx format. I focused my analysis on the school 2020–2021 year; the files were primarily available in .xlsx format, which I accessed via a publicly available API, downloading them separately for each U.S. state via a python script. For this project I used a subset of the columns that were available in this data set including TOT_ENR_M, TOT_ENR_F which represented total student counts faceted by gender. There was also more race-specific faceting represented by the RACE + M/F. I then used fields that represented disciplinary measures, SCH_DISCWODIS_* and SCH_DISCWDIS_*, for in school and out of school suspensions. For \"pipeline” outcomes I pulled expulsion and alternative placement counts with columns that contained the patterns of EXP|EXPEL|ALT|ALTR and law-enforcement contact referrals and arrests with the patterns of REF and ARR, all of which are faceted by race and gender. These patterns and definitions come from the U.S. Dept. of Ed’s Civil Rights Data Collection codebooks\n\n\nhttps://www.fec.gov/introduction-campaign-finance/election-results-and-voting-information/federal-elections-2020/\n\nThe data regarding election results for the 2020 election was obtained from the Federal Elections Commission website, an official website of the United States government. \n\n\n# Missing Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(purrr)\nlibrary(tidyr)\n\ndata_dir <- \"./data/2020-2021\"\n\nfiles <- list.files(\n  data_dir,\n  pattern = \"CRDC_2020-21_.*\\\\.xlsx$\",\n  full.names = TRUE\n)\n\nread_state_file <- function(path) {\n  df    <- suppressMessages(read_excel(path, sheet = 1, col_types = \"text\"))\n  fname <- basename(path)\n  \n  # State from LEA_STATE or filename\n  state_code <- if (\"LEA_STATE\" %in% names(df)) {\n    df$LEA_STATE[1]\n  } else {\n    m <- str_match(fname, \"CRDC_2020-21_([A-Z]{2})\\\\.xlsx\")\n    if (!is.na(m[1, 2])) m[1, 2] else NA_character_\n  }\n  \n  df |>\n    mutate(\n      source_file = fname,\n      state       = state_code\n    )\n}\n\ncrdc_raw <- map_dfr(files, read_state_file)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(viridis)   # for viridis color scale, optional\n\n# ID-like columns we do NOT want to treat as data fields\nid_cols <- c(\"state\", \"source_file\", \"SCHID\", \"NCESSCH\", \"LEAID\", \"LEA_STATE\")\nid_cols <- intersect(id_cols, names(crdc_raw))\n\n# All data columns that may contain missing values\ndata_cols <- setdiff(names(crdc_raw), id_cols)\n\nmissing_by_state <- crdc_raw |>\n  group_by(state) |>\n  summarise(\n    missing_count = sum(is.na(across(all_of(data_cols)))),\n    total_cells   = sum(length(data_cols)),\n    .groups       = \"drop\"\n  ) |>\n  arrange(desc(missing_count))\n\nmissing_by_state\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 52 × 3\n   state missing_count total_cells\n   <chr>         <int>       <int>\n 1 CA         17574461        3462\n 2 TX         15309152        3462\n 3 NY          8482950        3462\n 4 IL          7284956        3462\n 5 AZ          6991934        3462\n 6 FL          6907553        3462\n 7 OH          6148898        3462\n 8 MI          6075222        3462\n 9 PA          5115624        3462\n10 NC          4656149        3462\n# ℹ 42 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(missing_by_state,\n       aes(x = reorder(state, missing_count), y = missing_count)) +\n  geom_col(fill = \"steelblue\") +\n  coord_flip() +\n  labs(\n    title = \"Missing Value Count per State in Raw CRDC Data\",\n    x = \"State\",\n    y = \"Number of Missing Values\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](data_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\nThis widespread absence of California's data is evident in choropleth maps throughout the results sectionn. The state’s incomplete data highlights an important limitation of the CRDC dataset: even large states with major educational systems may provide inconsistent or incomplete reporting, which in turn affects nationwide comparisons. Texas is also missing quite a bit of data however which is notable.\n\n\n\n\n\n",
    "supporting": [
      "data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}